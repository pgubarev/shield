# Shield

Библиотека для упрощения написания сложных условий проверки доступа.
Может быть использована как вместе с Django, так и с любым другим python-фреймворком.

## Концепция

### AccessResolver

Основная входная точка для работы с доступом пользователям в контексте выполнения запроса.
Предоставляет методы для проверки доступа на выполнение конкретного действия,
а также специальный метод для получения всх доступных для пользователя действий.

### AccessController (Опционально)

Опциональный класс для работы с пользовательскими ролями. В некоторых системах доступ проверяется разными способами, в зависимости от каких-то атрибутов пользователя. Абстракция в виде AccessController позволяет унифицировать эти различия, приведя их единому интерфейсу.
AccessController не является частью библиотеки, но может быть реализован самостоятельно. Примеры реализаций и взаимодействия с контекстом будут добавлены в примеры использования.

### Instance

Опциональная сущность для которой выполняется проверка доступных действий.
Несмотря на то что instnace это опциональная сущность(ее можно определить как None и не использовать вовсе), instace может быть полезен для разделения проверок доступных действий для разных сущностей, тем самым упрощая условия внутри правил. Так например можно описать три разных AccessResolver для разных уровне внутри проекта:
- глобальный, без instance, для проверки действий пользователя которые не относятся к какой-либо сущности в системе, например доступ в amdmin панель
- отдельно два AccessResolver для проверки действий внутри публикации и комментариев к публикации.

### Context

Контекст выполнения проверки содержит всю необходимую информацию для выполнения проверок на уровне функция правил и позволяет универсально передавать весь необходимый набор данных в разные функции-правила, а так же обеспечивает единообразие интерфейса этих функций.

### Rule

Функция-правило, которая возвращает boolean значение, определяющее доступно действие для пользователя или нет.
Функция-правило только производит проверку и не должна выбрасывать исключения, если у пользователя нет доступа или текущий пользователь не определен. Функции-правила могут быть скомбинированы между собой и вычисляются в ленивом режиме.

### Permission

Действие определенное в системе. Оно может быть доступно или недоступно пользователю. Может быть выражено как перечислением доступных пользователю действий на уровне базы, так и расчитываться исключительно на основе каких то атрибутов. Например только автор публикации может вностить в нее корректировки, в этом случае доступность действия определяется проверкой совпадения id автора и id текущего пользователя.
